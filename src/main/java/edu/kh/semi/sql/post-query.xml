<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
<properties>

	<!-- 모든 블로그 게시물 리스트 조회 -->
	<!-- 게시글 상태가 정상 + 캐러셀 -->
	<entry key="selectPostListAll">
		SELECT  POST_NO, POST_TITLE, POST_CONTENT,
        TO_CHAR( CREATE_DT, 'YYYY-MM-DD' ) CREATE_DT,
        TO_CHAR( MODIFY_DT, 'YYYY-MM-DD' ) MODIFY_DT,
        READ_COUNT, LIKE_COUNT, BLOG_NO, BLOG_TITLE, MEMBER_NO
		FROM POST
		JOIN BLOG USING(BLOG_NO)
		WHERE POST_STATUS_CD IN (500, 505)
		ORDER BY POST_NO DESC
	</entry>
	
	<!-- 특정 블로그의 전체 게시물 수 조회 (삭제가 아닌 게시글) -->
	<entry key="getBlogListCount">
		SELECT COUNT(*) FROM POST
		JOIN BLOG USING(BLOG_NO)
		WHERE POST_STATUS_CD != 501
		AND BLOG_TITLE = ?
	</entry>
	
	<!-- 특정 블로그 전체 포스트 목록 조회 (삭제가 아닌 게시글) -->
	<entry key="selectBlogPostList">
		SELECT * FROM
    		(SELECT ROWNUM RNUM, A.*
    		FROM(SELECT * FROM
		        (SELECT  POST_NO, POST_TITLE, 
		                POST_CONTENT,
		               <![CDATA[CASE WHEN SYSDATE - CREATE_DT < 1]]> 
		                THEN TO_CHAR(  CREATE_DT, 'HH24:MI'  )  
		                ELSE TO_CHAR(  CREATE_DT, 'YYYY-MM-DD'  ) 
		                END AS "CREATE_DT",
		                READ_COUNT, REPORT_COUNT, LIKE_COUNT, BLOG.BLOG_NO, 
		                BLOG_TITLE, MEMBER_NO,
		                CATEGORY.CATEGORY_CD, CATEGORY_NM,
		                POST.POST_STATUS_CD, POST_STATUS_NM
		        FROM POST
		        JOIN BLOG ON(BLOG.BLOG_NO = POST.BLOG_NO)
		        JOIN CATEGORY ON(POST.CATEGORY_CD = CATEGORY.CATEGORY_CD)
		        JOIN POST_STATUS ON(POST.POST_STATUS_CD = POST_STATUS.POST_STATUS_CD)
		        )
		    WHERE POST_STATUS_CD != 501
		    AND BLOG_TITLE = ?
		    ORDER BY POST_NO DESC) A )
		WHERE RNUM BETWEEN ? AND ?   
	</entry>
	
	
	<!-- postNo로 포스트 상세 조회하기 -->
	<entry key="selectPost">
		SELECT  POST_NO, POST_TITLE, 
                POST_CONTENT,
                TO_CHAR(CREATE_DT ,'YYYY"년" MM"월" DD"일" HH24":" MI":" SS') CREATE_DT,
	        	TO_CHAR(MODIFY_DT ,'YYYY"년" MM"월" DD"일" HH24":" MI":" SS') MODIFY_DT,
	        	READ_COUNT, REPORT_COUNT, LIKE_COUNT, BLOG.BLOG_NO, 
	        	BLOG_TITLE, MEMBER_NO,
                CATEGORY.CATEGORY_CD, CATEGORY_NM,
                POST.POST_STATUS_CD, POST_STATUS_NM
       	FROM POST
       	JOIN BLOG ON(BLOG.BLOG_NO = POST.BLOG_NO)
       	JOIN CATEGORY ON(POST.CATEGORY_CD = CATEGORY.CATEGORY_CD)
       	JOIN POST_STATUS ON(POST.POST_STATUS_CD = POST_STATUS.POST_STATUS_CD)
       	WHERE POST.POST_STATUS_CD != 501
       	AND POST_NO = ?
	</entry>
	
	
	<!-- 포스트 조회수 증가 -->
	<entry key="plusReadCount">
		UPDATE POST SET
		READ_COUNT = READ_COUNT + 1
		WHERE POST_NO = ?
	</entry>
	
	

</properties>
